<!--
 ~ Copyright (c) 2023 by MoonSphere Systems
 ~ Originally developed by MiÅ‚osz Gilga <https://miloszgilga.pl>
 -->

<msph-modal-wrapper
  [isActive]="(isOpen$ | async)!"
  (emitOnClose)="handleEmitOnClose()"
  modalSize="xs"
  [header]="'msph.clientCommon.loginPage.formHeader' | translate">
  <div content>
    <div
      *ngIf="!loggedUser?.isVerified"
      class="msph-my-account__modal-image-container">
      <div
        class="msph-my-account__not-verified msph-my-account__not-verified--modal msph-my-account__content-colors--modal--viewport">
        <img
          src="{{ cdnPath }}/static/icon/user.svg"
          alt=""
          width="75"
          height="75"
          loading="eager" />
      </div>
      <p class="msph-my-account__modal-image-paragraph">
        {{
          'msph.clientCommon.myAccountsPage.modals.login.proceedNotVerified'
            | translate
        }}:
      </p>
      <p class="text-center">
        {{ loggedUser?.usernameOrEmailAddress }}
      </p>
    </div>
    <div
      *ngIf="loggedUser?.isVerified"
      class="msph-my-account__modal-image-container">
      <img
        src="{{ loggedUser?.thumbnailUrl }}"
        width="100px"
        height="100px"
        loading="eager"
        class="msph-my-account__verified-image msph-my-account__verified-image--modal msph-my-account__content-colors--modal--viewport"
        alt="" />
      <p class="msph-my-account__modal-image-paragraph">
        {{
          'msph.clientCommon.myAccountsPage.modals.login.proceedVerified'
            | translate
        }}:
      </p>
      <p class="text-center">
        {{ loggedUser?.usernameOrEmailAddress }}
      </p>
    </div>
    <form
      [formGroup]="loginForm"
      (ngSubmit)="handleLoginViaSavedAccount()"
      class="grid gap-3">
      <msph-password-input-toggler
        formControlIdentifier="password"
        i18nPrefix="clientCommon.loginPage"
        inputStyle="static">
        <msph-field-validator />
      </msph-password-input-toggler>
      <button
        [disabled]="loginForm.invalid || (isLoading$ | async)"
        class="msph-button msph-button--primary">
        <msph-lazy-button-spinner [isLoading]="(isLoading$ | async)!">
          {{ 'msph.clientCommon.loginPage.sendLoginForm' | translate }}
        </msph-lazy-button-spinner>
      </button>
    </form>
  </div>
</msph-modal-wrapper>
