<!--
 ~ Copyright (c) 2023 by MoonSphere Systems
 ~ Originally developed by MiÅ‚osz Gilga <https://miloszgilga.pl>
 -->

<form
  [formGroup]="loginForm"
  (ngSubmit)="handleSubmitLoginForm()"
  class="grid gap-3">
  <div class="grid gap-3" *ngIf="(activeStage$ | async) === 'login'">
    <msph-auth-common-form-input
      [maxLength]="100"
      formControlIdentifier="usernameOrEmailAddress"
      i18nPrefix="clientCommon.loginPage">
      <msph-field-validator />
    </msph-auth-common-form-input>
    <button
      type="button"
      class="msph-button msph-button--primary"
      [disabled]="(isNextButtonEnabled$ | async) === false"
      (click)="handleMoveForward()">
      {{ 'msph.common.utils.continue' | translate }}
    </button>
  </div>
  <div class="grid gap-3" *ngIf="(activeStage$ | async) === 'password'">
    <div class="flex flex-col">
      <p class="msph-auth__input-label">
        {{
          'msph.clientCommon.loginPage.formFields.usernameOrEmailAddress.value'
            | translate
        }}
      </p>
      <div class="relative w-full">
        <input
          [value]="loginForm.get('usernameOrEmailAddress')?.value"
          disabled
          type="text"
          class="msph-auth__input msph-auth__input--viewport w-full" />
        <button
          type="button"
          class="absolute right-2.5 top-1/2 -translate-y-1/2 msph-auth__top-nav-button"
          (click)="handleMoveBackward()"
          [disabled]="(isLoading$ | async) === true">
          {{ 'msph.common.utils.edit' | translate }}
        </button>
      </div>
    </div>
    <div class="flex flex-col gap-y-3">
      <msph-password-input-toggler
        formControlIdentifier="password"
        i18nPrefix="clientCommon.loginPage">
        <msph-field-validator />
      </msph-password-input-toggler>
      <msph-auth-checkbox-form-input
        formControlIdentifier="rememberAccount"
        i18nPrefix="clientCommon.loginPage"
        [additionalInfo]="true">
        <ng-container labelContent>
          {{
            'msph.clientCommon.loginPage.formFields.rememberAccount.value'
              | translate
          }}
        </ng-container>
      </msph-auth-checkbox-form-input>
    </div>
    <msph-lazy-button-spinner
      [isLoading]="(isLoading$ | async)!"
      [buttonDisabled]="loginForm.invalid">
      {{ 'msph.clientCommon.loginPage.sendLoginForm' | translate }}
    </msph-lazy-button-spinner>
  </div>
</form>
